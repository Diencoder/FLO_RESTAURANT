<!DOCTYPE html>
<html lang="en">
    <head th:replace="~{layout/header}"></head>
<body>


            <div class="profile-info col-md-9">
                <div class="panel">
                    <div class="table-data">
                        <div class="order">
                            <div class="head">
                            </div>
                            <table class="table">
                                <thead>
                                <tr>
                                    <th>Mã Đơn Hàng</th>
                                    <th>Tình Trạng Thanh Toán</th>
                                    <th>Tình Trạng Đơn Hàng</th>
                                    <th>Tổng Tiền</th>
                                    <th>Thông Tin Sản Phẩm</th>
                                    <th>Đánh Giá</th>
                                </tr>
                                </thead>
                                <tbody>
                                <!-- Lặp qua các đơn hàng và hiển thị thông tin -->
                                <tr th:each="order : ${orders}" th:unless="${order == null}">
                                    <td th:text="${order.orderId}"></td>
                                    <td th:text="${order.paymentStatus}"></td>
                                    <td th:text="${order.orderStatus}"></td>
                                    <td th:text="${order.totalAmount}"></td>
                                    <td>
                                        <table>
                                            <thead>
                                            <tr>
                                                <th>Tên Món Ăn</th>
                                                <th>Số Lượng</th>
                                                <th>Giá</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr th:each="item : ${order.items}" th:unless="${item == null}">
                                                <td th:text="${item.itemName}"></td>
                                                <td th:text="${item.quantity}"></td>
                                                <td th:text="${item.price}"></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                    <td>
                                        <div th:each="item : ${order.items}" th:unless="${item == null}">
                                            <h4 th:text="${item.itemName}"></h4>

                                            <!-- Kiểm tra nếu có đánh giá -->
                                            <div th:if="${item.review != null}">
                                                <p>Đánh giá: <span th:text="${item.review.rating}"></span> sao</p>
                                                <p th:text="${item.review.reviewText}"></p>

                                                <form th:action="@{/vieworder/addOrUpdateReview}" method="POST">
                                                    <input type="hidden" name="orderId" th:value="${order.orderId}">
                                                    <input type="hidden" name="foodId" th:value="${item.food != null ? item.food.id : '0'}">

                                                    <select name="rating" required>
                                                        <option value="1" th:selected="${item.review.rating == 1}">1 sao</option>
                                                        <option value="2" th:selected="${item.review.rating == 2}">2 sao</option>
                                                        <option value="3" th:selected="${item.review.rating == 3}">3 sao</option>
                                                        <option value="4" th:selected="${item.review.rating == 4}">4 sao</option>
                                                        <option value="5" th:selected="${item.review.rating == 5}">5 sao</option>
                                                    </select><br><br>

                                                    <textarea name="reviewText" placeholder="Nhập bình luận của bạn..." required th:text="${item.review.reviewText}"></textarea><br><br>

                                                    <button type="submit" class="btn btn-primary">Cập Nhật Đánh Giá</button>
                                                </form>

                                                <form th:action="@{/vieworder/deleteReview}" method="POST" style="margin-top: 10px;">
                                                    <input type="hidden" name="orderId" th:value="${order.orderId}">
                                                    <input type="hidden" name="foodId" th:value="${item.food != null ? item.food.id : '0'}">
                                                    <button type="submit" class="btn btn-danger" onclick="return confirm('Bạn có chắc chắn muốn xóa đánh giá này?')">Xóa Đánh Giá</button>
                                                </form>
                                            </div>

                                            <!-- Nếu chưa có đánh giá -->
                                            <div th:if="${item.review == null}">
                                                <form th:action="@{/vieworder/addOrUpdateReview}" method="POST">
                                                    <input type="hidden" name="orderId" th:value="${order.orderId}">
                                                    <input type="hidden" name="foodId" th:value="${item.food != null ? item.food.id : '0'}">

                                                    <select name="rating" required>
                                                        <option value="1">1 sao</option>
                                                        <option value="2">2 sao</option>
                                                        <option value="3">3 sao</option>
                                                        <option value="4">4 sao</option>
                                                        <option value="5">5 sao</option>
                                                    </select><br><br>

                                                    <textarea name="reviewText" placeholder="Nhập bình luận của bạn..." required></textarea><br><br>

                                                    <button type="submit" class="btn btn-success">Gửi Đánh Giá</button>
                                                </form>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div>

            </div>
        </div>
    </div>
</div>

<div>

</div>





<!-- Categories Start -->
<div class="container">
    <div class="row">




    </div>
</div>


<!-- Categories End  -->


<!-- Footer Start -->
<div class="container-fluid bg-dark text-light footer pt-5 mt-5 wow fadeIn" data-wow-delay="0.1s" style="visibility: visible; animation-delay: 0.1s; animation-name: fadeIn;">
    <div class="container py-5">
        <div class="row g-5">
            <div class="col-lg-3 col-md-6">
                <h4 class="section-title ff-secondary text-start text-primary fw-normal mb-4">Công Ty</h4>
                <!-- Các liên kết về thông tin công ty -->
                <a class="btn btn-link" href="">Giới Thiệu</a>
                <a class="btn btn-link" href="">Liên Hệ</a>
                <a class="btn btn-link" href="">Đặt Bàn</a>
                <a class="btn btn-link" href="">Chính Sách Bảo Mật</a>
                <a class="btn btn-link" href="">Điều Khoản &amp; Điều Kiện</a>
            </div>
            <div class="col-lg-3 col-md-6">
                <h4 class="section-title ff-secondary text-start text-primary fw-normal mb-4">Liên Hệ</h4>
                <!-- Thông tin liên hệ -->
                <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>Việt Nam, Bình Định</p>
                <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>113114115</p>
                <p class="mb-2"><i class="fa fa-envelope me-3"></i>FLO@gmail.com</p>
                <div class="d-flex pt-2">
                    <!-- Các biểu tượng mạng xã hội -->
                    <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-outline-light btn-social" href="https://www.facebook.com/xi.van.184"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-youtube"></i></a>
                    <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <h4 class="section-title ff-secondary text-start text-primary fw-normal mb-4">Giờ Mở Cửa</h4>
                <!-- Thông tin về giờ mở cửa -->
                <h5 class="text-light fw-normal">Thứ Hai - Thứ Bảy</h5>
                <p>09AM - 10PM</p>
                <h5 class="text-light fw-normal">Chủ Nhật</h5>
                <p>7AM - 12PM</p>
            </div>
            <div class="col-lg-3 col-md-6">
                <h4 class="section-title ff-secondary text-start text-primary fw-normal mb-4">Bản Tin</h4>
                <!-- Phần đăng ký nhận bản tin -->
                <p>Đăng ký để nhận thông tin và khuyến mãi mới nhất từ chúng tôi.</p>
                <div class="position-relative mx-auto" style="max-width: 400px;">
                    <input class="form-control border-primary w-100 py-3 ps-4 pe-5" type="text" placeholder="Email của bạn">
                    <button type="button" class="btn btn-primary py-2 position-absolute top-0 end-0 mt-2 me-2">Đăng Ký</button>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="copyright">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    © <a class="border-bottom" href="#">FLO_RESTAURANT</a>, Bảo Lưu Tất Cả Quyền.
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <div class="footer-menu">
                        <!-- Liên kết về các trang khác -->
                        <a href="">Trang Chủ</a>
                        <a href="">Cookies</a>
                        <a href="">Trợ Giúp</a>
                        <a href="">Câu Hỏi Thường Gặp</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Footer End -->

<!-- Back to Top -->
<!-- Nút quay lại đầu trang -->
<a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top" style="display: none;"><i class="bi bi-arrow-up"></i></a>


<!-- Thư viện JavaScript -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="lib/wow/wow.min.js"></script>
<script src="lib/easing/easing.min.js"></script>
<script src="lib/waypoints/waypoints.min.js"></script>
<script src="lib/counterup/counterup.min.js"></script>
<script src="lib/owlcarousel/owl.carousel.min.js"></script>
<script src="lib/tempusdominus/js/moment.min.js"></script>
<script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
<script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>

<!-- Mã JavaScript của Template -->
<script src="js/main.js"></script>


</body>
</html>
